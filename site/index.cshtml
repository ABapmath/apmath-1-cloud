@{
	var seedRequest = Request.Params["seed"];
	var iterRequest = Request.Params["iter"];
	var seed = 1;
	var iter = 1;
	var clear = int.TryParse(seedRequest, out seed) && int.TryParse(iterRequest, out iter);
	var errorMssage = "no seed and/or number of iterations provided, please input http://spmath-1-cloud.azurewebsites.net?seed=5?iter=5";
}
<html>
<head>
  <meta charset="utf-8">

  <title>Braun-Robinson</title>
</head>
<body>
<script type="text/javascript">
@if(!clear){
	Response.Write(String.Format("alert({0});", errorMssage));
}
else{
    var n=3;
    var m=3;
    Random rng = new Random(seed);
	var A = new double[m*n];
	for(int i=0;i<m;i++){
		for(int j=0;j<n;j++)
		{
			double t;
           	A[i * n + j] = rng.NextDouble() * 20.0;
		}
	}

    var count = 1;

    var max_x = new double[m];
    var min_y = new double[n];

    var kx = new int[m];
    var ky = new int[n];

    var _x = new double[iter, m];
    var _y = new double[iter, n];
    var v = new double[iter];
    v[0] = A[0];

    kx[0] = 1;
    _x[0, 0] = 1;
    ky[0] = 1;
    _y[0, 0] = 1;
    for (int i = 1; i < m; i++)
    {
        kx[i] = 0;
        _x[0, i] = 0;
    }
    for (int i = 1; i < n; i++)
    {
        ky[i] = 0;
        _y[0, i] = 0;
    }


    while (count < iter)
    {
        for (int j = 0; j < n; j++){
            _y[count, j] = ky[j] / (double)count;
	   }
        for (int i = 0; i < m; i++)
        {
            double sum_x = 0;
            int _i = i * n;
            for (int j = 0; j < n; j++)
            {
                sum_x += A[_i + j] * _y[count, j];
            }
            max_x[i] = sum_x;
        }

        int x = 0;
        double max = max_x[0];
        for (int i = 1; i < m; i++)
        {
            if (max < max_x[i])
            {
                max = max_x[i];
                x = i;
            }
        }


        for (int i = 0; i < m; i++){
            _x[count, i] = kx[i] / (double)count;
	   }
        for (int j = 0; j < n; j++)
        {
            double sum_y = 0;
            int _j = j * m;
            for (int i = 0; i < m; i++)
            {
                sum_y += A[i + _j] * _x[count, i];
            }
            min_y[j] = sum_y;
        }

        int y = 0;
        double min = min_y[0];
        double Vmax = min_y[0];
        for (int j = 1; j < n; j++)
        {
            if (min > min_y[j])
            {
                min = min_y[j];
                y = j;
            }
        }

        v[count] = 0;
        for (int i = 0; i < m; i++){
            for (int j = 0; j < n; j++){
                v[count] += A[i * n + j] * _y[count, j] * _x[count, i];
		 }
	   }
        count++;
        kx[x]++;
        ky[y]++;
    }

    var resx = new double[m];
    for (int i = 0; i < m; i++){
        resx[i] = kx[i] / (double)count;}
    var resy = new double[n];
    for (int j = 0; j < n; j++){
        resy[j] = ky[j] / (double)count;}
    double resv = 0;
    for (int i = 0; i < m; i++){
        for (int j = 0; j < n; j++){
            resv += A[i * n + j] * resy[j] * resx[i];}}
}
</script>
</body>
</html>